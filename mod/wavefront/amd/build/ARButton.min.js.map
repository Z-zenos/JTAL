{"version":3,"file":"ARButton.min.js","sources":["../src/ARButton.js"],"sourcesContent":["class ARButton {\n\n\tstatic createButton( renderer, sessionInit = {} ) {\n\n\t\tconst button = document.createElement( 'button' );\n\n\t\tfunction showStartAR( /*device*/ ) {\n\n\t\t\tif ( sessionInit.domOverlay === undefined ) {\n\n\t\t\t\tvar overlay = document.createElement( 'div' );\n\t\t\t\toverlay.style.display = 'none';\n\t\t\t\tdocument.body.appendChild( overlay );\n\n\t\t\t\tvar svg = document.createElementNS( 'http://www.w3.org/2000/svg', 'svg' );\n\t\t\t\tsvg.setAttribute( 'width', 38 );\n\t\t\t\tsvg.setAttribute( 'height', 38 );\n\t\t\t\tsvg.style.position = 'absolute';\n\t\t\t\tsvg.style.right = '20px';\n\t\t\t\tsvg.style.top = '20px';\n\t\t\t\tsvg.addEventListener( 'click', function () {\n\n\t\t\t\t\tcurrentSession.end();\n\n\t\t\t\t} );\n\t\t\t\toverlay.appendChild( svg );\n\n\t\t\t\tvar path = document.createElementNS( 'http://www.w3.org/2000/svg', 'path' );\n\t\t\t\tpath.setAttribute( 'd', 'M 12,12 L 28,28 M 28,12 12,28' );\n\t\t\t\tpath.setAttribute( 'stroke', '#fff' );\n\t\t\t\tpath.setAttribute( 'stroke-width', 2 );\n\t\t\t\tsvg.appendChild( path );\n\n\t\t\t\tif ( sessionInit.optionalFeatures === undefined ) {\n\n\t\t\t\t\tsessionInit.optionalFeatures = [];\n\n\t\t\t\t}\n\n\t\t\t\tsessionInit.optionalFeatures.push( 'dom-overlay' );\n\t\t\t\tsessionInit.domOverlay = { root: overlay };\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tlet currentSession = null;\n\n\t\t\tasync function onSessionStarted( session ) {\n\n\t\t\t\tsession.addEventListener( 'end', onSessionEnded );\n\n\t\t\t\trenderer.xr.setReferenceSpaceType( 'local' );\n\n\t\t\t\tawait renderer.xr.setSession( session );\n\n\t\t\t\tbutton.textContent = 'STOP AR';\n\t\t\t\tsessionInit.domOverlay.root.style.display = '';\n\n\t\t\t\tcurrentSession = session;\n\n\t\t\t}\n\n\t\t\tfunction onSessionEnded( /*event*/ ) {\n\n\t\t\t\tcurrentSession.removeEventListener( 'end', onSessionEnded );\n\n\t\t\t\tbutton.textContent = 'START AR';\n\t\t\t\tsessionInit.domOverlay.root.style.display = 'none';\n\n\t\t\t\tcurrentSession = null;\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tbutton.style.display = '';\n\n\t\t\tbutton.style.cursor = 'pointer';\n\t\t\tbutton.style.left = 'calc(50% - 50px)';\n\t\t\tbutton.style.width = '100px';\n\n\t\t\tbutton.textContent = 'START AR';\n\n\t\t\tbutton.onmouseenter = function () {\n\n\t\t\t\tbutton.style.opacity = '1.0';\n\n\t\t\t};\n\n\t\t\tbutton.onmouseleave = function () {\n\n\t\t\t\tbutton.style.opacity = '0.5';\n\n\t\t\t};\n\n\t\t\tbutton.onclick = function () {\n\n\t\t\t\tif ( currentSession === null ) {\n\n\t\t\t\t\tnavigator.xr.requestSession( 'immersive-ar', sessionInit ).then( onSessionStarted );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcurrentSession.end();\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t\tfunction disableButton() {\n\n\t\t\tbutton.style.display = '';\n\n\t\t\tbutton.style.cursor = 'auto';\n\t\t\tbutton.style.left = 'calc(50% - 75px)';\n\t\t\tbutton.style.width = '150px';\n\n\t\t\tbutton.onmouseenter = null;\n\t\t\tbutton.onmouseleave = null;\n\n\t\t\tbutton.onclick = null;\n\n\t\t}\n\n\t\tfunction showARNotSupported() {\n\n\t\t\tdisableButton();\n\n\t\t\tbutton.textContent = 'AR NOT SUPPORTED';\n\n\t\t}\n\n\t\tfunction stylizeElement( element ) {\n\n\t\t\telement.style.position = 'absolute';\n\t\t\telement.style.bottom = '20px';\n\t\t\telement.style.padding = '12px 6px';\n\t\t\telement.style.border = '1px solid #fff';\n\t\t\telement.style.borderRadius = '4px';\n\t\t\telement.style.background = 'rgba(0,0,0,0.1)';\n\t\t\telement.style.color = '#fff';\n\t\t\telement.style.font = 'normal 13px sans-serif';\n\t\t\telement.style.textAlign = 'center';\n\t\t\telement.style.opacity = '0.5';\n\t\t\telement.style.outline = 'none';\n\t\t\telement.style.zIndex = '999';\n\n\t\t}\n\n\t\tif ( 'xr' in navigator ) {\n\n\t\t\tbutton.id = 'ARButton';\n\t\t\tbutton.style.display = 'none';\n\n\t\t\tstylizeElement( button );\n\n\t\t\tnavigator.xr.isSessionSupported( 'immersive-ar' ).then( function ( supported ) {\n\n\t\t\t\tsupported ? showStartAR() : showARNotSupported();\n\n\t\t\t} ).catch(function(value) {\n  \t\t\t\tconsole.log(value.name + \": \" + value.message);\n\t\t\t \tshowARNotSupported \n\t\t\t});\n\t\t\t\n\t\t\treturn button;\n\n\t\t} else {\n\n\t\t\tconst message = document.createElement( 'a' );\n\n\t\t\tif ( window.isSecureContext === false ) {\n\n\t\t\t\tmessage.href = document.location.href.replace( /^http:/, 'https:' );\n\t\t\t\tmessage.innerHTML = 'WEBXR NEEDS HTTPS'; // TODO Improve message\n\n\t\t\t} else {\n\n\t\t\t\tmessage.href = 'https://immersiveweb.dev/';\n\t\t\t\tmessage.innerHTML = 'WEBXR NOT AVAILABLE';\n\n\t\t\t}\n\n\t\t\tmessage.style.left = 'calc(50% - 90px)';\n\t\t\tmessage.style.width = '180px';\n\t\t\tmessage.style.textDecoration = 'none';\n\n\t\t\tstylizeElement( message );\n\n\t\t\treturn message;\n\n\t\t}\n\n\t}\n\n}\n\nexport { ARButton };\n"],"names":["renderer","sessionInit","button","document","createElement","showARNotSupported","style","display","cursor","left","width","onmouseenter","onmouseleave","onclick","textContent","stylizeElement","element","position","bottom","padding","border","borderRadius","background","color","font","textAlign","opacity","outline","zIndex","navigator","id","xr","isSessionSupported","then","supported","undefined","domOverlay","overlay","body","appendChild","svg","createElementNS","setAttribute","right","top","addEventListener","currentSession","end","path","optionalFeatures","push","root","onSessionStarted","session","onSessionEnded","setReferenceSpaceType","setSession","removeEventListener","requestSession","showStartAR","catch","value","console","log","name","message","window","isSecureContext","href","location","replace","innerHTML","textDecoration"],"mappings":"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"}